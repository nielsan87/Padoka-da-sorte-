<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Jogo Casual - Coleta com Inimigos</title>
<style>
  canvas {
    background: linear-gradient(to bottom, #87ceeb, #1e90ff);
    display: block;
    margin: 0 auto;
    border: 3px solid #333;
    border-radius: 10px;
  }
</style>
</head>
<body>

<canvas id="game" width="400" height="400"></canvas>

<script>
// Variáveis do canvas e contexto
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

// Jogador
let player = {
  x: 180,
  y: 350,
  width: 40,
  height: 40,
  speed: 5,
  lives: 3
};

// Item para coletar
let item = {
  x: Math.random() * 360,
  y: Math.random() * 200,
  width: 20,
  height: 20,
};

// Inimigos (array)
let enemies = [
  { x: 50, y: 50, width: 30, height: 30, speedX: 2, speedY: 2 },
  { x: 300, y: 100, width: 30, height: 30, speedX: -3, speedY: 1.5 }
];

// Pontuação
let score = 0;
let gameOver = false;

// Sons
const collectSound = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
const hitSound = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');

// Desenha jogador
function drawPlayer() {
  ctx.fillStyle = 'green';
  ctx.fillRect(player.x, player.y, player.width, player.height);
}

// Desenha item
function drawItem() {
  ctx.fillStyle = 'yellow';
  ctx.beginPath();
  ctx.arc(item.x + item.width/2, item.y + item.height/2, item.width/2, 0, Math.PI * 2);
  ctx.fill();
}

// Desenha inimigos
function drawEnemies() {
  ctx.fillStyle = 'red';
  enemies.forEach(enemy => {
    ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
  });
}

// Atualiza posição inimigos
function updateEnemies() {
  enemies.forEach(enemy => {
    enemy.x += enemy.speedX;
    enemy.y += enemy.speedY;

    // Rebater nas bordas
    if(enemy.x < 0 || enemy.x + enemy.width > canvas.width) enemy.speedX *= -1;
    if(enemy.y < 0 || enemy.y + enemy.height > canvas.height) enemy.speedY *= -1;
  });
}

// Limpa tela
function clear() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}

// Verifica colisão entre dois retângulos
function collision(rect1, rect2) {
  return (
    rect1.x < rect2.x + rect2.width &&
    rect1.x + rect1.width > rect2.x &&
    rect1.y < rect2.y + rect2.height &&
    rect1.y + rect1.height > rect2.y
  );
}

// Atualiza jogo
function update() {
  clear();
  drawPlayer();
  drawItem();
  drawEnemies();

  // Mostrar pontuação e vidas
  ctx.fillStyle = 'white';
  ctx.font = '20px Arial';
  ctx.fillText('Pontuação: ' + score, 10, 25);
  ctx.fillText('Vidas: ' + player.lives, 300, 25);

  if (gameOver) {
    ctx.fillStyle = 'red';
    ctx.font = '40px Arial';
    ctx.fillText('Fim de Jogo!', 100, 200);
    return;
  }

  updateEnemies();

  // Verifica se jogador pegou o item
  if (collision(player, item)) {
    score++;
    collectSound.play();
    // Reposiciona o item
    item.x = Math.random() * (canvas.width - item.width);
    item.y = Math.random() * (canvas.height - item.height - 50); // deixar espaço pra info na tela
  }

  // Verifica colisão com inimigos
  enemies.forEach(enemy => {
    if (collision(player, enemy)) {
      player.lives--;
      hitSound.play();
      // Posiciona jogador no começo
      player.x = 180;
      player.y = 350;
      if (player.lives <= 0) {
        gameOver = true;
      }
    }
  });

  requestAnimationFrame(update);
}

// Controle do jogador com teclado
document.addEventListener('keydown', function (e) {
  if (gameOver) return;

  switch (e.key) {
    case 'ArrowLeft':
      if (player.x > 0) player.x -= player.speed;
      break;
    case 'ArrowRight':
      if (player.x + player.width < canvas.width) player.x += player.speed;
      break;
    case 'ArrowUp':
      if (player.y > 0) player.y -= player.speed;
      break;
    case 'ArrowDown':
      if (player.y + player.height < canvas.height) player.y += player.speed;
      break;
  }
});

// Inicia o jogo
update();
</script>

</body>
</html>
